#!/usr/bin/env Rscript
#
# Generates the table containing the number of groups generated by each tool.
# Input: The CSV file containing the combined decomposition results for all the bugs (generated by `src/python/main/analysis/concatenate_untangled_lines.py`).
# Output: The path where save the output table as a .tex file.

library(tidyverse)
library(xtable)

args = commandArgs(trailingOnly=TRUE)

if (length(args)!=2) {
  stop("Please provide an input file and output file.", call.=FALSE)
}
inputFile = args[1]
outputFile = args[2]

data <- read.csv(inputFile)
data$bug_id <- as_factor(data$bug_id)

groupCount <- data %>% group_by(project, bug_id, treatment) %>% summarise(group_count = n_distinct(group), .groups = 'keep')
summary <- groupCount %>% group_by(treatment) %>% summarise("Min."=min(group_count), "Max."=max(group_count), "Median"=median(group_count), "Std. dev."=sd(group_count))
summary.table <- xtable(summary)

print(summary.table, only.contents = TRUE, booktabs = TRUE, timestamp	= NULL, comment = TRUE, include.rownames = FALSE, file=outputFile)
