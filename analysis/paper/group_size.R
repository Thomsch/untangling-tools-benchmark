#!/usr/bin/env Rscript
#
# Generates the table containing the size of the groups generated by each tool.
# Input: The CSV file containing the combined decomposition results for all the bugs (generated by `src/python/main/analysis/concatenate_untangled_lines.py`).
# Output: The path where save the output table as a .tex file.

library(tidyverse)
library(xtable)

args = commandArgs(trailingOnly=TRUE)

if (length(args)!=2) {
  stop("Please provide an input file and output file.n", call.=FALSE)
}
inputFile = args[1]
outputFile = args[2]

data <- read.csv(inputFile)
data$BugId <- as_factor(data$BugId)

groupSize <- data %>% group_by(Project, BugId, Treatment, Group) %>% summarise(n = n())
summary <- groupSize %>% group_by(Treatment) %>% summarise("Min."=min(n), "Max."=max(n), "Median"=median(n), "Std. dev."=sd(n))

summary.table <- xtable(summary)

print(summary.table, only.contents = TRUE, booktabs = TRUE, timestamp	= NULL, comment = TRUE, include.rownames = FALSE, file=outputFile)
